# 1. Cron 表达式原理

```
    *       *       *       *       *
    ↓       ↓       ↓       ↓       ↓
分(0~59) 时(0~23) 日(1~31) 月(1-12) 星期(0~7)
```

Cron 常见语法
- 每隔 5 分钟执行一次: */5 * * * * echo hello > /tmp/x.log
- 第 1~5 分钟各执行一次: 1-5 * * * * /usr/bin/python /tmp/data/my.py
- 每天 10 点, 22 点整点执行一次: 0 10,22 * * * echo bye | tail -1

> 已知当前 UNIX 时间为 1559871544, 即 2019-06-07 09:39:04, 执行 Cron 表达式 `30 * * * *`, 如何计算命令的下一次调度时间

首先需要根据 Cron 表达式计算出一份枚举

| 单位 | 符合表达式的内容 |
| :-: | :-: |
| 分钟 | 30 |
| 小时 | [0, 1, 2, 3, ... , 23] |
| 日期 | [1, 2, 3, ... , 31] |
| 月份 | [1, 2, 3, ... , 12] |

我们使用 `Cronexpr` 库解析 Cron 表达式

# 2. etcd 协调服务

- Golang 生态中类似 Zookeeper 的组件, 实现了 Raft 算法;
- 将数据存储在集群中的高可用 K-V 存储;
- 允许应用实时监听存储中的 K-V 变化;
- 能够容忍单点故障, 能够应对网络分区(满足AP);

# 3. 系统架构

## 3.2 Worker 内部架构

![image](https://user-images.githubusercontent.com/17758731/59159906-c6062e00-8b02-11e9-952b-35b386c67994.png)
